@function sharp($repeating, $angle, $stops...) {
  @return sharp-stagger($repeating, "linear", $angle, 0, $stops...);
}

@function sharp-linear($angle, $stops...) {
  @return sharp-stagger(false, "linear", $angle, 0, $stops...);
}

@function sharp-repeating-linear($angle, $stops...) {
  @return sharp-stagger(true, "linear", $angle, 0, $stops...);
}

@function sharp-radial($angle, $stops...) {
  @return sharp-stagger(false, "radial", $angle, 0, $stops...);
}

@function sharp-repeating-radial($angle, $stops...) {
  @return sharp-stagger(true, "radial", $angle, 0, $stops...);
}

@function sharp-stagger($repeating, $type, $angle, $stagger, $stops...) {
  $gradient: ();

  @for $i from 1 through length($stops) {
    $stop: nth($stops, $i);
    $dump: ();

    @if $i > 1 {
      $previous-stop: nth($stops, $i - 1);
      $dump: append($dump, nth($stop, 1) (nth($previous-stop, 2) + $stagger));
      @if $i != length($stops) {
          $dump: append($dump, $stop);
      }
    }
    @else {
      $dump: append($dump, $stop);
    }

    $gradient: join($gradient, $dump, comma);
  }

  @if $type == "radial" {
    @if $repeating {
      @return repeating-radial-gradient($angle, $gradient...);
    }
    @else {
      @return radial-gradient($angle, $gradient...);
    }
  }
  @else {
    @if $repeating {
      @return repeating-linear-gradient($angle, $gradient...);
    }
    @else {
      @return linear-gradient($angle, $gradient...);
    }
  }
}

$tr: transparent;

/// @link http://lea.verou.me/css3patterns/#honeycomb
/// @param {color} $background-color [#fb1]
/// @param {color} $line-color [#b71]
/// @param {length} $scale [60px]
@mixin honeycomb($background-color: #fb1, $line-color: #b71, $scale: 60px) {
  @if $background-color != #fb1 {
    @if $line-color == #b71 {
      $line-color: darken(adjust-hue(desaturate($background-color, 17%), -7deg), 13%);
    }
  }

  background:
      sharp-radial(circle farthest-side at 0% 50%, $background-color 23.5%, $tr) $scale * 21 / 60 $scale / 2,
      sharp-radial(circle farthest-side at 0% 50%, $line-color 24%, $tr) $scale * 19 / 60 $scale / 2,
      sharp-linear(to bottom, $background-color 14%, $tr 85%, $background-color),
      sharp-linear(150deg, $background-color 24%, $line-color 26%, $tr 74%, $line-color 76%, $background-color),
      sharp-linear(30deg,  $background-color 24%, $line-color 26%, $tr 74%, $line-color 76%, $background-color),
      sharp-linear(90deg, $line-color 2%, $background-color 98%, $line-color);
  background-size: $scale / 1.5 $scale;
  background-color: $background-color;
}

/// @link http://lea.verou.me/css3patterns/#tablecloth
/// @param {color} $color [rgb(200, 0, 0)]
/// @param {color} $background-color [white]
/// @param {length} $scale [50px]
/// @param {opacity} $color-opacity [.5]
/// @param {length} $color-width [50%]
@mixin gingham($color: rgb(200, 0, 0), $background-color: white, $scale: 50px, $color-opacity: .5, $color-width: 50%) {
  $color: rgba($color, $color-opacity);
  $stops: $color $color-width, $tr;
  background-image:
    sharp-linear(90deg, $stops...),
    sharp-linear(0deg,  $stops...);
  background-size: $scale $scale;
  background-color: $background-color;
}

/// @link http://lea.verou.me/css3patterns/#chocolate-weave
/// @param {color} $background-color [#753]
/// @param {length} $scale [25px]
/// @param {color} $first-color [#dca]
/// @param {color} $second-color [#a85]
@mixin weave($background-color: #753, $scale: 25px, $first-color: #dca, $second-color: #a85) {
  @if $background-color != #753 {
    @if $second-color == #a85 {
      $second-color: lighten(adjust-hue(desaturate($background-color, 7%), 6deg), 17%);
    }
    @if $first-color == #dca {
      $first-color: lighten(adjust-hue(saturate($background-color, 3%), 10deg), 44%);
    }
  }
  background-image:
    sharp-linear(45deg, $first-color 12%, $tr 88%, $first-color),
    sharp-linear(135deg, $tr 37%, $second-color 63%, $tr),
    sharp-linear(45deg, $tr 37%, $first-color 63%, $tr);
  background-color: $background-color;
  background-size: $scale $scale;
}

/// @link http://lea.verou.me/css3patterns/#seigaiha
/// @param {color} $color [white]
/// @param {color} $background-color [silver]
/// @param {length} $scale [100px]
@mixin seigaiha($color: white, $background-color: silver, $scale: 100px) {
  background-image:
    radial-gradient(circle at 100% 150%, $background-color 24%, $color 25%, $color 28%, $background-color 29%, $background-color 36%, $color 36%, $color 40%, $tr 40%),
    radial-gradient(circle at 0 150%, $background-color 24%, $color 25%, $color 28%, $background-color 29%, $background-color 36%, $color 36%, $color 40%, $tr 40%),
    radial-gradient(circle at 50% 100%, $color 10%, $background-color 11%, $background-color 23%, $color 24%, $color 30%, $background-color 31%, $background-color 43%, $color 44%, $color 50%, $background-color 51%, $background-color 63%, $color 64%, $color 71%, $tr 71%),
    radial-gradient(circle at 100% 50%, $color 5%, $background-color 6%, $background-color 15%, $color 16%, $color 20%, $background-color 21%, $background-color 30%, $color 31%, $color 35%, $background-color 36%, $background-color 45%, $color 46%, $color 49%, $tr 49%),
    radial-gradient(circle at 0 50%, $color 5%, $background-color 6%, $background-color 15%, $color 16%, $color 20%, $background-color 21%, $background-color 30%, $color 31%, $color 35%, $background-color 36%, $background-color 45%, $color 46%, $color 49%, $tr 49%);
  background-color: $background-color;
  background-size: $scale $scale / 2;
}

/// @link http://lea.verou.me/css3patterns/#japanese-cube
/// @param {color} $background-color [#556]
/// @param {color} $second-color [#445]
/// @param {color} $third-color [#99a]
/// @param {length} $scale [140px]
@mixin cubes($background-color: #556, $second-color: #445, $third-color: #99a, $scale: 140px) {
    @if $background-color != #556 {
      @if $second-color == #445 {
        $second-color: darken(saturate($background-color, 2%), 7%);
      }
      @if $third-color == #99a {
        $third-color: lighten($background-color, 26%);
      }
    }
    $stops: $second-color 12%, $tr 12.5%, $tr 87%, $second-color 87.5%;
    $other-stops: $third-color 25%, $tr 25.5%, $tr 75%, $third-color 75%;
    $long-dim: $scale;
    $short-dim: $scale * 4 / 7;
    background:
      linear-gradient(30deg,  $stops...),
      linear-gradient(150deg, $stops...),
      linear-gradient(30deg,  $stops...) $short-dim / 2 $long-dim / 2,
      linear-gradient(150deg, $stops...) $short-dim / 2 $long-dim / 2,
      linear-gradient(60deg,  $other-stops...),
      linear-gradient(60deg,  $other-stops...) $short-dim / 2 $long-dim / 2;
    background-size: $short-dim $long-dim;
    background-color: $background-color;
}

/// @link http://thenewcode.com/1057/SVG-Patterns-of-Japan
/// @param {color} $line-color [black]
/// @param {color} $background-color [white]
/// @param {length} $scale [140px]
@mixin asanoha($line-color: black, $background-color: white, $scale: 140px) {
    $stops: $background-color 12%, $line-color 13%, $tr 87%, $line-color 88%, $background-color;
    $other-stops: $line-color 1%, $tr 99%, $line-color;
    $other-stops-thinner: $line-color .5%, $tr 99.5%, $line-color;
    $last-stops: $tr 24.5%, $line-color 25.5%, $tr 74.5%, $line-color 75.5%, $tr;
    $long-dim: $scale;
    $short-dim: $scale * 4 / 7;
    background:
      sharp-linear(0deg,   $other-stops-thinner...),
      sharp-linear(0deg,   $other-stops-thinner...) 0 $long-dim / 2,
      sharp-linear(120deg, $last-stops...),
      sharp-linear(60deg,  $last-stops...),
      sharp-linear(30deg,  $stops...),
      sharp-linear(150deg, $stops...),
      sharp-linear(30deg,  $stops...) $short-dim / 2 $long-dim / 2,
      sharp-linear(150deg, $stops...) $short-dim / 2 $long-dim / 2,
      sharp-linear(90deg,  $other-stops...),
      sharp-linear(90deg,  $other-stops...) $short-dim / 2 $long-dim / 2;
    background-size: $short-dim $long-dim;
    background-color: $background-color;
}

/// @link http://lea.verou.me/css3patterns/#marrakesh
/// @param {color} $background-color [white]
/// @param {color} $color [midnightblue]
/// @param {length} $scale [90px]
/// @param {length} $dot-size [$scale / 10 (9px)]
@mixin marrakesh($background-color: white, $color: midnightblue, $scale: 90px, $dot-size: $scale / 10) {
    @if $dot-size == 9px {
      $dot-size: $scale / 10;
    }
    background-color: $background-color;
    background-image:
      // sharp-stagger(false, "radial", circle, 1, $color 43%, $tr),
      // sharp-stagger(false, "radial", circle, 1, $tr 31.4%, $color 39%, $tr 78%, $color 84%, $tr);
      sharp-stagger(false, "radial", circle, 1, $color $dot-size, $tr),
      sharp-stagger(false, "radial", circle, 1, $tr $scale * 2/9, $color $scale * 25/90, $tr $scale * 5/9, $color $scale * 54/90, $tr);
    background-size: $scale / 3 $scale / 3, $scale $scale
}

xyz {
  @include marrakesh;
}
